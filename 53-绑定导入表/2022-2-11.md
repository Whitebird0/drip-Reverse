绑定导入表结构
---

绑定导入表位于数据目录项的第12项
									
PE加载EXE相关的DLL时，首先会根据IMAGE_IMPORT_DESCRIPTOR结构中的TimeDateStamp来判断是否要重新计算IAT表中的地址。										
											
	TimeDateStamp == 0  未绑定																
	TimeDateStamp == -1 已绑定 真正的绑定时间为IMAGE_BOUND_IMPORT_DESCRIPTOR的TimeDateStamp										


----
绑定导入表结构体

      typedef struct _IMAGE_BOUND_IMPORT_DESCRIPTOR {							
          DWORD   TimeDateStamp;							
          WORD    OffsetModuleName;	//DLL的名字						
          WORD    NumberOfModuleForwarderRefs;				//表示接下来还有多少个依赖的绑定导入表，指向的结构体与IMAGE_BOUND_IMPORT_DESCRIPTOR略微不同			
      // Array of zero or more IMAGE_BOUND_FORWARDER_REF follows							
      } IMAGE_BOUND_IMPORT_DESCRIPTOR,  *PIMAGE_BOUND_IMPORT_DESCRIPTOR;							

---

      typedef struct _IMAGE_BOUND_FORWARDER_REF {							
          DWORD   TimeDateStamp;							
          WORD    OffsetModuleName;//DLL的名字，不是RVA，地址为第一个DESCRIPTOR的值+OffsetModuleName							
          WORD    Reserved;	//这个没用						
      } IMAGE_BOUND_FORWARDER_REF, *PIMAGE_BOUND_FORWARDER_REF;							
							
![](https://raw.githubusercontent.com/Whitebird0/tuchuang/main/QQ%E6%88%AA%E5%9B%BE20220211150557.png)

**特别说明：**										
	
当IMAGE_BOUND_IMPORT_DESCRIPTOR结构中的TimeDateStamp与DLL文件标准PE头中的TimeDateStamp值不相符时，或者DLL需要重新定位的时候，就会重新计算IAT中的值.										

