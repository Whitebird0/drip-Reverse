如何定位导出表：
---

数据目录项的第一个结构，就是导出表.

            typedef struct _IMAGE_DATA_DIRECTORY {
                DWORD   VirtualAddress;//导出表的RVA
                DWORD   Size;//导出表的大小
            } IMAGE_DATA_DIRECTORY, *PIMAGE_DATA_DIRECTORY;


这个结构，只是说明导出表在哪里，有多大，并不是真正的导出表.

导出表结构
---

因为在VirtualAddress中存储的是RVA,如果想在FileBuffer中定位，必须要先将该RVA转换成FOA.

导出表结构
						
              typedef struct _IMAGE_EXPORT_DIRECTORY {								
                  DWORD   Characteristics;    // 未使用				
                  DWORD   TimeDateStamp;      // 时间戳				
                  WORD    MajorVersion;       // 未使用				
                  WORD    MinorVersion;       // 未使用				
                  DWORD   Name;               // 指向该导出表文件名字符串				
                  DWORD   Base;               // 导出函数起始序号				
                  DWORD   NumberOfFunctions;  // 所有导出函数的个数				
                  DWORD   NumberOfNames;      // 以函数名字导出的函数个数				
                  DWORD   AddressOfFunctions;         // 导出函数地址表RVA								
                  DWORD   AddressOfNames;             // 导出函数名称表RVA								
                  DWORD   AddressOfNameOrdinals;      // 导出函数序号表RVA								
              } IMAGE_EXPORT_DIRECTORY, *PIMAGE_EXPORT_DIRECTORY;								

![](https://i.loli.net/2021/11/12/wSsBH8PdFbyTMKe.png)


            
